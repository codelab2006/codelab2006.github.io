<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><title> TypeScript 笔记十（模块） - 黄永健的个人站点 </title><link rel="stylesheet" href="/assets/css/icons.css"/><link rel="stylesheet" href="/assets/css/normalize.css"/><link rel="stylesheet" href="/assets/css/styles.css"/></head><body class="d-flex flex-direction-column"><header class="p-relative"><div class="d-flex h-4 px-8px bg-primary text-light align-items-center justify-content-space-between"><h1>网络日志</h1><button id="nav-toggler" class="icon-nav-toggler"></button></div><div id="nav-container" class="bg-primary px-8px align-items-center"><nav><ul class="d-flex"><li class="mx-16px my-16px"><a class="text-light" href="/">首页</a></li><li class="mx-16px my-16px"><a class="text-light" href="/blog">网络日志</a></li><li class="mx-16px my-16px"><a class="text-light" href="/codelab">Codelab</a></li><li class="mx-16px my-16px"><a class="text-light" href="/about.html">关于作者</a></li></ul></nav></div></header><main class="flex-grow-1"><div class="d-flex justify-content-center my-48px px-8px"><article class="container"><h2 class="p-6px bb-1px"> TypeScript 笔记十（模块） </h2><div class="my-16px"><span class="d-block p-6px">作者：黄永健</span><span class="d-block p-6px">日期：2020-03-10</span></div><div class="my-32px p-6px content"><h3 id="介绍">介绍</h3><p>从 ECMAScript 2015 开始, JavaScript 有了模块的概念，TypeScript 也具有这个概念。模块中的代码在自己的作用域中执行，不在全局作用域中执行，意味着模块中声明的变量，方法，类，在模块外是不可见的。你需要将明确的将它们导出，并在使用的模块中进行导入。</p><h3 id="export">Export</h3><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// StringValidator.ts</span>
<span class="k">export</span> <span class="kr">interface</span> <span class="nx">StringValidator</span> <span class="p">{</span>
  <span class="nx">isAcceptable</span><span class="p">(</span><span class="nx">s</span><span class="p">:</span> <span class="nx">string</span><span class="p">):</span> <span class="nx">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// ZipCodeValidator.ts</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">StringValidator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./StringValidator</span><span class="dl">'</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">const</span> <span class="nx">numberRegexp</span> <span class="o">=</span> <span class="sr">/^</span><span class="se">[</span><span class="sr">0-9</span><span class="se">]</span><span class="sr">+$/</span><span class="p">;</span>

<span class="k">export</span> <span class="kd">class</span> <span class="nx">ZipCodeValidator</span> <span class="kr">implements</span> <span class="nx">StringValidator</span> <span class="p">{</span>
  <span class="nx">isAcceptable</span><span class="p">(</span><span class="nx">s</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="nx">numberRegexp</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div><h4 id="重命名导出">重命名导出</h4><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nx">ZipCodeValidator</span> <span class="kr">implements</span> <span class="nx">StringValidator</span> <span class="p">{</span>
  <span class="nx">isAcceptable</span><span class="p">(</span><span class="nx">s</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="nx">numberRegexp</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">export</span> <span class="p">{</span> <span class="nx">ZipCodeValidator</span> <span class="p">};</span>
<span class="k">export</span> <span class="p">{</span> <span class="nx">ZipCodeValidator</span> <span class="k">as</span> <span class="nx">mainValidator</span> <span class="p">};</span>
</code></pre></div></div><h4 id="re-exports">Re-exports</h4><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">class</span> <span class="nx">ParseIntBasedZipCodeValidator</span> <span class="p">{</span>
  <span class="nx">isAcceptable</span><span class="p">(</span><span class="nx">s</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">s</span><span class="p">).</span><span class="nx">toString</span><span class="p">()</span> <span class="o">===</span> <span class="nx">s</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="c1">// Export original validator but rename it</span>
<span class="k">export</span> <span class="p">{</span> <span class="nx">ZipCodeValidator</span> <span class="k">as</span> <span class="nx">RegExpBasedZipCodeValidator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ZipCodeValidator</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div><h4 id="合并导出">合并导出</h4><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="o">*</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./StringValidator</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// exports 'StringValidator'</span>
<span class="k">export</span> <span class="o">*</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ZipCodeValidator</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// exports const 'numberRegexp' and 'ZipCodeValidator'</span>
<span class="k">export</span> <span class="o">*</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ParseIntBasedZipCodeValidator</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// exports the 'ParseIntBasedZipCodeValidator'</span>
</code></pre></div></div><h4 id="默认导出">默认导出</h4><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// JQuery.d.ts</span>
<span class="nx">declare</span> <span class="kd">let</span> <span class="nx">$</span><span class="p">:</span> <span class="nx">JQuery</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="nx">$</span><span class="p">;</span>

<span class="c1">// Main.ts</span>
<span class="k">import</span> <span class="nx">$</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">jquery</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">$</span><span class="p">(</span><span class="dl">'</span><span class="s1">button.continue</span><span class="dl">'</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="dl">'</span><span class="s1">Next Step...</span><span class="dl">'</span><span class="p">);</span>
</code></pre></div></div><h4 id="export-all-as-x">Export all as x</h4><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">utilities</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./utilities</span><span class="dl">'</span><span class="p">;</span>

<span class="k">import</span> <span class="p">{</span> <span class="nx">utilities</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./index</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div><h3 id="import">Import</h3><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ZipCodeValidator</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ZipCodeValidator</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">myValidator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ZipCodeValidator</span><span class="p">();</span>
</code></pre></div></div><h4 id="重命名导入">重命名导入</h4><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">ZipCodeValidator</span> <span class="k">as</span> <span class="nx">ZCV</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ZipCodeValidator</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div><h4 id="导入为一个变量">导入为一个变量</h4><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">validator</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./ZipCodeValidator</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">v</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">validator</span><span class="p">.</span><span class="nx">ZipCodeValidator</span><span class="p">();</span>
</code></pre></div></div><h4 id="导入具有副作用的模块">导入具有副作用的模块</h4><p>尽管不建议这样做，但某些模块会设置一些可由其他模块使用的全局状态。</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// TODO ...</span>
</code></pre></div></div><h3 id="export--and-import--require">export = and import = require()</h3><p>TypeScript 支持 export = 和 import = require() 语法。</p><div class="language-typescript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ZipCodeValidator.ts</span>
<span class="kd">let</span> <span class="nx">numberRegexp</span> <span class="o">=</span> <span class="sr">/^</span><span class="se">[</span><span class="sr">0-9</span><span class="se">]</span><span class="sr">+$/</span><span class="p">;</span>
<span class="kd">class</span> <span class="nx">ZipCodeValidator</span> <span class="p">{</span>
  <span class="nx">isAcceptable</span><span class="p">(</span><span class="nx">s</span><span class="p">:</span> <span class="nx">string</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">s</span><span class="p">.</span><span class="nx">length</span> <span class="o">===</span> <span class="mi">5</span> <span class="o">&amp;&amp;</span> <span class="nx">numberRegexp</span><span class="p">.</span><span class="nx">test</span><span class="p">(</span><span class="nx">s</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
<span class="k">export</span> <span class="o">=</span> <span class="nx">ZipCodeValidator</span><span class="p">;</span>

<span class="c1">// Test.ts</span>
<span class="k">import</span> <span class="nx">zip</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./ZipCodeValidator</span><span class="dl">'</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">strings</span> <span class="o">=</span> <span class="p">[</span><span class="dl">'</span><span class="s1">Hello</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">98052</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">101</span><span class="dl">'</span><span class="p">];</span>
<span class="kd">let</span> <span class="nx">validator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">zip</span><span class="p">();</span>
<span class="nx">strings</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="nx">s</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span>
    <span class="s2">`'</span><span class="p">${</span><span class="nx">s</span><span class="p">}</span><span class="s2">' - </span><span class="p">${</span><span class="nx">validator</span><span class="p">.</span><span class="nx">isAcceptable</span><span class="p">(</span><span class="nx">s</span><span class="p">)</span> <span class="p">?</span> <span class="dl">'</span><span class="s1">matches</span><span class="dl">'</span> <span class="p">:</span> <span class="dl">'</span><span class="s1">does not match</span><span class="dl">'</span><span class="p">}</span><span class="s2">`</span>
  <span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div><h3 id="可选模块加载和其他高级加载方案">可选模块加载和其他高级加载方案</h3><h3 id="使用其他-javascript-库">使用其他 JavaScript 库</h3><h3 id="结构模块指南">结构模块指南</h3></div></article></div></main><footer class="min-h-16 px-8px bg-primary p-relative"><div id="footer-panel" class="bg-primary px-8px"></div></footer><script src="/assets/js/script.js"></script></body></html>